# Chap 01 Node.js 優勢

## Why JavaScript ?

- 低成本
  - 後端也採用 JavaScript，就可減少學習一門後端語言的成本
  - 大量 package (npm) 支持
- 非常流行
  - Photoshop CC 安裝目錄：Node.js runtime (Adobe)
  - 阿里巴巴、騰訊、Facebook、Google、百度等
  - Node.js：前端構建的一部分
    - 壓縮代碼
    - 減少文件體積
  - npm 上有 700000 個 packages
- 運用範圍
  - 從 Node.js 問世，JavaScript 的生態越來越完善，JavaScript 能做的事越來越多
  - 移動端應用 (React Native, Apache Weex)
  - 桌面端應用 Electron
  - 物聯網運用 iot.js
  - 服務端運用 Egg.js

綜觀來看，JavaScript 非常適合個人獨立開發、新創公司使用的一門語言

## Node.js 不適合大型運用？

其實見仁見智，大型運用的定義對每個工程師的哲學概念都不一樣

- 應用的組成
  - 一個完備的 Web 應用其實是多門技術的綜合體
    - 解決某個問題有非常多的解決方案
  - 應用組成可能包括：
    - Web 介面顯示邏輯
    - 後端業務邏輯
    - 緩存
    - 資料庫
    - 消息佇列
    - 日誌分析 (option)
    - 數據分析 (option)
- 應用的種類
  - I/O 密集型
    - 互聯網 (從資料庫讀取數據輸出到用戶瀏覽器)
  - CPU 密集型
    - 頻繁計算任務的應用
    - Node.js 在這方面確實是短板
- 應用服務的過程
  - 請求過程：用戶透過瀏覽器發送請求，由網卡接收 TCP 連接，通知內核，內核再去調用相對應的服務端程序
  - 回應過程：獲取數據，透過內核調用磁盤的驅動程序，把數據讀入緩存，這樣就可在 Web 應用程序中獲取數據並進行數據處理，最終調用內核，將數據透過網卡發送給客戶端
- 應用的瓶頸
  - I/O 密集型的瓶頸在磁盤的讀寫上
    - 可購買 SSD 磁盤來提昇性能
    - 一般數據庫軟體的數據都是存儲在文件上
      - 可考慮添加內存型緩存來解決這個瓶頸，緩存經常訪問的數據，比如 Redis
      - 其次才考慮搭建或擴充數據庫集群來提高併發
  - CPU 密集型應用瓶頸則在 CPU 上
    - 只能增加 CPU 處理核心來解決瓶頸
- 分佈式應用
  - 大型普通應用與分佈式應用其實是不同概念
  - 可將分佈式應用理解為一個團隊，每一個成員都是一個節點，一個大的項目要讓成員合作完成，那麼成員與成員之間就存在一些溝通成本，甚至有的成員與成員之間勾心鬥角，說話陽奉陰違、推託責任，也可能成員生病在家休養，無法工作
  - 面對這些問題，Node.js 的優勢並不能很好顯現 (不是不能做，而是沒有完善的基礎設施)
  - 分佈式的真正定義
    - 在多台服務器中部署不同服務模組，以進程為基本單位，派發到服務器上，透過遠程調用 (RPC) 通信並協同工作，最終對外提供服務
    - 相比較 Node.js 目前分佈式基礎設施，Go 語言的基礎措施則完善多了，特別在 Docker 這個項目上，充分證明了 Go 語言的優勢
      - Node.js 社區 TJ 因為要開發分佈式應用而轉向 Go 語言
  - 其實不必過度擔心分佈式問題，JavaScript 畢竟最初只是一個運行在瀏覽器端的腳本語言而已，JavaScript 不是萬能的，為什麼一定要把它用在操作系統級別的開發上？尋找一個更合適的語言不是更好？
  - 就像此刻我們選擇 JavaScript 構建 Web 應用
- 多進程 Node.js
  - 了解以上知識點，Node.js 跟大型運用關係不大，但只能利用單核的問題已經被解決了，後面使用的 Egg.js 框架中的 Egg-Cluster 模組就利用多進程非常友好解決這個問題

